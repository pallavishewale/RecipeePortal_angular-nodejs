(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[244],{1597:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(1),a=n(3),i=n(80),r=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isRendered:void 0===Object(i.a)()},n}return Object(o.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(a.Component)},2004:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n(1402),a=n(3),i=n(2),r=n(32),l=(Object(i.declareStringWithPlaceholders)("accessibility-utils-ui.accessibility-utils.positionInSet"));function s(t){var e=t.posInSet,n=t.setSize,i=t.onRenderDescribedElement,s=function(t,e){return Object(r.b)(l,{pos:t.toString(),size:e.toString()})}(e,n),c=Object(o.a)();return a.createElement(a.Fragment,null,a.createElement("div",{id:c,hidden:!0},s),i(c))}},2849:function(t,e,n){"use strict";n.r(e),n.d(e,"PhotoPickerStore",(function(){return H})),n.d(e,"StandalonePhotoPicker",(function(){return Ke})),n.d(e,"PhotoPicker",(function(){return Te})),n.d(e,"initIcons",(function(){return _e}));var o=n(5),a=n.n(o),i=n(10),r=n(48),l=n(47),s=n(69),c=n(4);function u(t,e){void 0===e&&(e=null);var n="".concat("PhotoPicker").concat(t,"Action");return Object(c.a)(n,{featureName:"PhotoPicker",exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var p=u("UploadedPhotoTooSmall"),d=u("CancelButtonClicked","PhotoPickerCancelButtonClicked"),m=u("CloseButtonClicked","PhotoPickerCloseButtonClickedAction"),g=u("DoneButtonClicked","PhotoPickerDoneButtonClickedAction"),h=u("UploadNewPhotoButtonClicked","PhotoPickerUploadNewPhotoButtonClickedAction"),f=u("ImageEditPaneDismissed","PhotoPickerImageEditPaneDismissed"),b=u("ImageUpdated"),v=u("LoadedCurrentImage"),S=u("LoadedEmptyImage"),y=u("LoadedNewImage"),P=u("SomethingWentWrong"),I=u("UploadStarted","PhotoPickerApplyButtonClicked"),E=u("UploadProgress"),C=u("UploadSucceeded"),x=u("WarningDismissed"),O=u("Keyboard"),U=u("ImageRotate"),R=u("Zoom"),w=u("ImageLoaded"),A=u("DragStarted"),k=u("DragProgress"),L=u("ResetEditCanvas"),j=u("EmptyImageRendered"),N=u("SetImageUpdated"),D=u("PhotoListImageSelected"),B=u("NewImageUploaded"),T=u("PhotoListLoadPhotos"),M=function(){return(M=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},_=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,i=e.length;a<i;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))},z={xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,imageRotationAngle:0,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0,imageUpdated:!0},W={photoPicker:{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0,isUploadedPhotoTooSmall:!1},editCanvas:M(M({},z),{originalCanvasState:z}),photoList:{selectedIndex:0,imageUrls:[]}},F=Object(s.combineReducers)({photoPicker:Object(r.a)().handleAction(d,G).handleAction(m,G).handleAction(g,G).handleAction(f,G).handleAction(x,(function(t){return Object(i.j)(t,{status:"READY",warning:void 0})})).handleAction(v,(function(t,e){var n=e.payload.dataUrl;return Object(i.j)(t,{dataUrl:t.dataUrl||n,currentImageDataUrl:t.currentImageDataUrl||n,isUpdated:!!e.payload.isSuggestedPhoto||!!e.payload.isPhotoListPresent})})).handleAction(y,(function(t,e){return Object(i.j)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:e.payload.fileName})})).handleAction(S,(function(t,e){return Object(i.j)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:void 0})})).handleAction(I,(function(t,e){return Object(i.j)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})})).handleAction(E,(function(t,e){return"IN_PROGRESS"===t.status?Object(i.j)(t,{uploadDuration:e.payload.now-t.uploadStart}):t})).handleAction(C,(function(t,e){return Object(i.j)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})})).handleAction(P,(function(t,e){return Object(i.j)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})})).handleAction(b,(function(t){return Object(i.j)(t,{isUpdated:!0})})).handleAction(p,(function(t,e){return Object(i.j)(t,e.payload)})).done(W.photoPicker),editCanvas:Object(r.a)().handleAction(L,K).handleAction(O,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(R,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(w,(function(t,e){return Object(i.j)(t,M(M({},e.payload),{originalCanvasState:t.originalCanvasState.initialRender?Object(i.j)(t.originalCanvasState,e.payload):t.originalCanvasState}))})).handleAction(A,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(k,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(N,(function(t){return Object(i.j)(t,{imageUpdated:!0})})).handleAction(j,(function(t){return Object(i.j)(t,{initialRender:!1})})).handleAction(d,K).handleAction(m,K).handleAction(g,K).handleAction(f,K).handleAction(U,(function(t,e){return Object(i.j)(t,e.payload)})).done(W.editCanvas),photoList:Object(r.a)().handleAction(D,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(S,(function(t){return Object(i.j)(t,{selectedIndex:-1})})).handleAction(B,(function(t,e){return Object(i.j)(t,{selectedIndex:e.payload.selectedIndex,imageUrls:_([e.payload.newImageUrl],t.imageUrls,!0)})})).handleAction(T,(function(t,e){return Object(i.j)(t,e.payload)})).handleAction(d,Y).handleAction(m,Y).handleAction(g,Y).handleAction(f,Y).done(W.photoList)}),H=Object(l.a)("PhotoPickerStore",F,(function(t){return{getPhotoPickerState:function(){return t.photoPicker},getEditCanvasState:function(){return t.editCanvas},getPhotoListState:function(){return t.photoList}}}));function G(t){return Object(i.j)(t,{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,isUpdated:!1,fileName:void 0})}function K(t){return Object(i.j)(t,W.editCanvas)}function Y(t){return Object(i.j)(t,W.photoList)}var X=n(365),Z=n.n(X),V=n(425),q=n.n(V),J=n(969),Q=n(490),$=n(1269),tt=n(3),et=n(76),nt=n.n(et),ot=n(55),at=n.n(ot),it=n(132);function rt(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var lt={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},st=function(t){return t*Math.PI/180};function ct(t,e,n,o,a,i){t.save(),t.translate(e/2,e/2),t.transform.apply(t,lt[o]),t.rotate(st(n)),t.translate(-e/2,-e/2),i(t,a),t.restore()}function ut(t,e,n,o){var a=st(o),i=lt[n],r=i[0],l=i[2];return{x:(e=(t=(t-=128)*r+(e-=128)*i[1])*l+e*i[3])*Math.sin(a)+t*Math.cos(a)+128,y:e*Math.cos(a)-t*Math.sin(a)+128}}function pt(t,e,n){return Math.min(n,Math.max(t,e))}var dt=n(42),mt=n.n(dt),gt=n(130),ht=["absoluteScale","imageRotationAngle","xpos","ypos"],ft=n(2254),bt=n(879),vt=n(1294),St=n(2538),yt=n(2001),Pt=n(119),It=n(14),Et=Object(Pt.c)((function(){return Object(It.db)({closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"}})})),Ct=function(t){var e=t.onClick,n=t.dataLogName,o=t.ariaLabel,a=t.title,i=Et();switch(t.buttonType){case"Primary":return tt.createElement(ft.a,{disabled:t.disabled,onClick:e,"data-log-name":n,ariaLabel:o,title:a,componentRef:t.buttonRef},t.buttonLabel);case"Action":return tt.createElement(bt.a,{className:i.removeButton,iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,disabled:t.disabled,title:a},t.buttonLabel);case"Icon":return tt.createElement(vt.a,{content:a,styles:{root:i.closeButton}},tt.createElement(St.a,{iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,ariaLabel:o}));case"Default":return tt.createElement(yt.a,{onClick:e,"data-log-name":n,ariaLabel:o,title:a},t.buttonLabel);default:return t}},xt=n(768),Ot=n(2051),Ut=n(2899),Rt=Object(Pt.c)((function(t,e){return Object(It.db)({root:Object(It.eb)({margin:"7px 0",color:t.palette.neutralPrimary},null==e?void 0:e.root),text:Object(It.eb)(t.fonts.medium,null==e?void 0:e.text)})})),wt=function(t){var e=Rt(Object(xt.a)(),t.styles),n="UNKNOWN"===t.warning,o="IMAGE_TOO_SMALL_ERROR"===t.warning,a=n||o?Ot.a.error:Ot.a.warning,i=n?void 0:t.onDismiss;return tt.createElement(Ut.a,{className:e.root,messageBarType:a,onDismiss:i,isMultiline:!0,"aria-live":"polite",styles:e,dismissButtonAriaLabel:t.dismissButtonAriaLabel},t.warningText)},At=n(2675),kt=n(2895),Lt=Object(Pt.c)((function(t,e){var n=t.palette;return Object(It.db)({modal:Object(It.eb)({width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button--icon &hover":{color:n.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:n.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:n.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:n.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:n.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:n.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:n.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:n.neutralTertiaryAlt}}},null==e?void 0:e.modal),picker:Object(It.eb)(t.fonts.medium,{padding:32,overflow:"hidden"},null==e?void 0:e.root),header:Object(It.eb)(t.fonts.xLarge,{display:"flex",alignContent:"space-between",color:n.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},null==e?void 0:e.header),endActions:{marginTop:t.spacing.l1,alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:62,padding:"0px 4px",fontSize:t.fonts.medium.fontSize,borderRadius:4}}},editCanvasAndPhotoListContainer:{display:"flex",padding:"0px 8px"}})})),jt=function(t){var e=t.hideTitleText,n=t.isComponentInline,o=t.titleText,a=t.closeIcon,i=t.infoBar,r=t.uploadPhoto,l=t.editCanvas,s=t.applyButton,c=t.cancelButton,u=t.removeButton,p=t.onDismiss,d=t.focusTrapRef,m=t.hideEndActions,g=t.imageEditorDescription,h=t.customUploadButton,f=t.photoList,b=t.styles,v=Lt(Object(xt.a)(),b),S=tt.createElement(tt.Fragment,null,!n&&a,!e&&tt.createElement("div",{className:v.header,id:"dialogTitle",role:"heading","aria-level":1},o),i,r,tt.createElement("div",{className:v.editCanvasAndPhotoListContainer},l,f),g,!m&&tt.createElement("div",{className:v.endActions},s,c,u),h);return tt.createElement(tt.Fragment,null,n?tt.createElement("div",{id:"lpc-photo-picker",className:v.picker},S):tt.createElement(At.a,{className:"lpc_nested_popup",containerClassName:v.modal,isOpen:!0,onDismiss:p,titleAriaId:"dialogTitle"},tt.createElement(kt.a,{id:"lpc-photo-picker",className:v.picker,componentRef:d,firstFocusableSelector:"photoPickerFirstFocusableSelector"},S)))},Nt=Object(Pt.c)((function(t,e){return Object(It.db)({fileInput:{display:"none"},button:Object(It.eb)({color:t.palette.themePrimary,padding:0,margin:"0 0 12px -4px"},null==e?void 0:e.button)})})),Dt=function(t){var e=Nt(Object(xt.a)(),t.styles),n=tt.useRef(null);return tt.createElement(tt.Fragment,null,tt.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:n,onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.onFileSelected(e.currentTarget.files[0],t.isPhotoListPresent)},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),tt.createElement(bt.a,{componentRef:t.buttonRef,className:"".concat(e.button," ").concat("photoPickerFirstFocusableSelector"),iconProps:{iconName:"Add"},onClick:function(){var e;null===(e=n.current)||void 0===e||e.click(),t.onUploadNewPhoto()}},t.uploadText))},Bt=n(845),Tt=n(1279),Mt=n(202),_t=n(58),zt=n(549),Wt=n(327);function Ft(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),n=atob(e),o=n.length,a=new ArrayBuffer(o),i=new Uint8Array(a),r=0;r<o;r++)i[r]=n.charCodeAt(r);return a}(t));if(65496!==e.getUint16(0,!1))return 1;for(var n,o=e.byteLength,a=2;a<o;){var i=e.getUint16(a,!1);if(a+=2,65505===i){if(1165519206!==e.getUint32(a+=2,!1))break;var r=18761===e.getUint16(a+=6,!1);a+=e.getUint32(a+4,r);var l=e.getUint16(a,r);a+=2;for(var s=0;s<l;s++)if(274===e.getUint16(a+12*s,r))return(n=e.getUint16(a+12*s+8,r))<1||n>8?1:n}else{if(65280!=(65280&i))break;a+=e.getUint16(a,!1)}}return 1}var Ht=n(2915),Gt=n(1417),Kt=n(158),Yt=Object(Kt.a)((function(t,e){return Object(It.db)({sliderContainer:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},sliderButton:{selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},editControls:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",height:32},root:Object(It.eb)({selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},null==e?void 0:e.root),slideBox:Object(It.eb)({padding:"0 10px"},null==e?void 0:e.slideBox),thumb:Object(It.eb)({border:"2px solid ".concat(t.palette.themePrimary)},null==e?void 0:e.thumb),activeThumb:Object(It.eb)({backgroundColor:t.palette.themePrimary},null==e?void 0:e.activeThumb),inactiveThumb:Object(It.eb)({backgroundColor:t.palette.themeLight},null==e?void 0:e.inactiveThumb),announcement:{position:"absolute",width:1,height:1,margin:-1,overflowX:"hidden",overflowY:"hidden"}})})),Xt=function(t){return"".concat(Math.round(t),"Â°")},Zt=function(t){return"".concat(Math.round(t))},Vt=function(t){var e,n,o=Object(xt.a)(),a=Yt(o,t.styles),i=t.onImageRotate,r=t.setBaseAngleForStraightening,l=tt.useCallback((function(e){var n=e-t.imageRotationAngle+t.baseAngleForStraightening;i(n)}),[i,t.baseAngleForStraightening,t.imageRotationAngle]),s=tt.useCallback((function(){i(90),r(t.baseAngleForStraightening+90)}),[i,r,t.baseAngleForStraightening]),c=tt.useCallback((function(){t.onImageRotate(-90),t.setBaseAngleForStraightening(t.baseAngleForStraightening-90)}),[t]),u=null!==(n=null===(e=t.imagePositionInformationString)||void 0===e?void 0:e.call(t,{p0:Xt(t.imageRotationAngle)}))&&void 0!==n?n:Xt(t.imageRotationAngle);return tt.createElement("div",{className:a.editControls},tt.createElement(St.a,{className:a.sliderButton,title:t.counterClockwiseString,ariaLabel:t.counterClockwiseString,onClick:c,onRenderIcon:qt,disabled:t.isPhotoUploading}),tt.createElement(vt.a,{content:u,styles:{root:a.sliderContainer}},tt.createElement(Ht.a,{styles:{root:a.root,slideBox:a.slideBox,thumb:a.thumb,activeSection:a.activeThumb,inactiveSection:a.inactiveThumb},min:-45,max:45,step:1,value:t.imageRotationAngle-t.baseAngleForStraightening,showValue:!1,disabled:t.isPhotoUploading,originFromZero:!0,onChange:l,ariaValueText:Zt,"aria-label":t.rotateString})),tt.createElement(St.a,{className:a.sliderButton,disabled:t.isPhotoUploading,title:t.clockwiseString,ariaLabel:t.clockwiseString,onClick:s,onRenderIcon:Jt}),tt.createElement("div",{"aria-live":"assertive",role:"status",className:a.announcement},Xt(t.imageRotationAngle)))};function qt(){return tt.createElement("span",null,tt.createElement(Gt.x,null))}function Jt(){return tt.createElement("span",null,tt.createElement(Gt.y,null))}var Qt=function(t){return"".concat(t,"%")},$t=function(t,e){return Math.round(100*(t*(e-1)+1))},te=function(t){var e,n,o=tt.useState(!1),a=o[0],i=o[1],r=tt.useRef(0),l=t.zoom,s=tt.useCallback((function(e,n,o){var a,i;!t.image||t.maximumScale<1||isNaN(e)?null==o||o.stopPropagation():l((a=e,i=t.maximumScale,Math.round((a/100-1)/(i-1)*100)/100-t.relativeScale),.5*t.canvasSize,.5*t.canvasSize)}),[t.image,t.maximumScale,t.relativeScale,l,t.canvasSize]),c=tt.useCallback((function(e){l(e,t.canvasSize/2,t.canvasSize/2),i(!0),r.current&&clearTimeout(r.current),r.current=window.setTimeout((function(){return i(!1)}),3e3)}),[l,r,t.canvasSize]);tt.useEffect((function(){return function(){return clearTimeout(r.current)}}),[r]);var u=Object(xt.a)(),p=Yt(u,t.styles),d=pt(2*t.stepSize,.1,.2),m=$t(0,t.maximumScale),g=$t(1,t.maximumScale),h=$t(t.relativeScale,t.maximumScale),f=$t(pt(t.stepSize,.05,.1),t.maximumScale)-$t(0,t.maximumScale),b=t.maximumScale<=1?t.zoomAtMaxString:null!==(n=null===(e=t.imageScaleInformationString)||void 0===e?void 0:e.call(t,{p0:Qt(h)}))&&void 0!==n?n:Qt(h);return tt.createElement("div",{className:p.editControls},tt.createElement(St.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorSubtract"},title:t.zoomOutString,ariaLabel:t.zoomOutString,onClick:function(){return c(-d)},disabled:t.isPhotoUploading||t.zoomOutDisabled}),tt.createElement(vt.a,{content:b,styles:{root:p.sliderContainer}},tt.createElement(Ht.a,{styles:{root:p.root,slideBox:p.slideBox,thumb:p.thumb,activeSection:p.activeThumb,inactiveSection:p.inactiveThumb},ariaValueText:Qt,ariaLabel:t.zoomString,min:m,max:g,disabled:t.isPhotoUploading||t.maximumScale<=1,step:f,value:h,showValue:!1,onChange:s})),tt.createElement(St.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorAddition"},title:t.zoomInString,ariaLabel:t.zoomInString,onClick:function(){return c(d)},disabled:t.isPhotoUploading||t.zoomInDisabled}),a&&tt.createElement("div",{"aria-live":"assertive",role:"status",className:p.announcement},Qt($t(t.relativeScale,t.maximumScale))))},ee=n(2893),ne=n(2275),oe=n(1415),ae=Object(Pt.c)((function(t,e){var n=t.palette;return Object(It.db)({editPivot:{height:46},link:Object(It.eb)({lineHeight:10,width:46,height:46,padding:0,marginRight:0,color:n.neutralSecondary},null==e?void 0:e.link),linkSelected:Object(It.eb)({color:n.neutralDark,fontWeight:600},null==e?void 0:e.linkSelected),button:Object(It.eb)({flex:"0 1 100%",height:44},null==e?void 0:e.button),buttonText:Object(It.eb)({fontSize:10,marginTop:5},null==e?void 0:e.buttonText)})})),ie=function(t){var e=Object(xt.a)(),n=ae(e,t.styles),o=t.setSelectedKey,a=tt.useCallback((function(t){var e;(null===(e=null==t?void 0:t.props)||void 0===e?void 0:e.itemKey)&&o(t.props.itemKey)}),[o]),i=tt.useCallback((function(e){if(!(null==e?void 0:e.itemKey))return null;var o=e.itemKey,a="Rotate"===o?[tt.createElement(Gt.w,{key:o}),t.rotateString]:[tt.createElement(oe.h,{key:o}),t.zoomString],i=a[0],r=a[1];return tt.createElement("span",{className:n.button},i,tt.createElement("div",{className:n.buttonText},r))}),[t.rotateString,t.zoomString,n.button,n.buttonText]);return tt.createElement(ee.a,{styles:{root:n.editPivot,link:n.link,linkIsSelected:n.linkSelected},"aria-label":t.pivotString,selectedKey:t.selectedKey,onLinkClick:a,headersOnly:!0,"aria-disabled":t.isPhotoUploading},tt.createElement(ne.a,{itemKey:"Zoom",onRenderItemLink:i}),tt.createElement(ne.a,{itemKey:"Rotate",onRenderItemLink:i}))},re=function(){return(re=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},le=Object(Pt.c)((function(t,e,n,o){return Object(It.db)({editControlsPlaceholderSpace:{height:32},editCanvas:Object(It.eb)({backgroundColor:t.palette.neutralLight,cursor:e?"move":"inherit"},null==n?void 0:n.root),isDropActive:{outline:"1px solid purple"},invisible:re({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),canvasContainer:{margin:o?"0 0 0 auto":"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:Object(It.eb)({color:t.palette.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},null==n?void 0:n.textboy),initials:Object(It.eb)({fontSize:128,lineHeight:128},null==n?void 0:n.initials)})})),se=function(t){t.stopPropagation(),t.preventDefault()},ce=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]};var ue,pe=Object(it.c)((function(t){return H.getSelectors(t).getEditCanvasState()}),(function(t){return{onReset:function(){return t(L())},onKeyboardEvent:function(e){return t(O({xpos:e.xpos,ypos:e.ypos}))},onZoomEvent:function(e){return t(R({absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,zoomOutDisabled:e.zoomOutDisabled,zoomInDisabled:e.zoomInDisabled,xpos:e.xpos,ypos:e.ypos}))},onImageLoaded:function(e){return t(w({naturalMin:e.naturalMin,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,stepSize:e.stepSize,maximumScale:e.maximumScale,orientation:e.orientation,imageRotationAngle:e.imageRotationAngle,image:e.image,zoomInDisabled:e.zoomInDisabled,initialRender:e.initialRender,xpos:e.xpos,ypos:e.ypos,absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,imageUpdated:e.imageUpdated}))},onDragStart:function(e){return t(A({moving:e.moving,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onDragProgress:function(e){return t(k({moving:e.moving,xpos:e.xpos,ypos:e.ypos,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onEmptyImageRendered:function(){return t(j())},onRotateEvent:function(e){return t(U({imageRotationAngle:e.imageRotationAngle}))}}}))((function(t){var e=tt.useRef(!1),n=tt.useRef(null),o=tt.useRef(null),a=Object(Tt.a)(t.personDisplayName,Object(Mt.a)()),i=!t.image||t.maximumScale<=1||t.progress>0,r=t.image,l=t.progress>0&&t.progress<1,s=!i||t.naturalHeight!==t.naturalWidth,c=Object(xt.a)(),u=le(c,s,t.styles.canvas,t.isPhotoListPresent),p=tt.useState(),d=p[0],m=p[1],g=tt.useState(0),h=g[0],f=g[1],b=tt.useState(),v=b[0],S=b[1],y=tt.useCallback((function(t){return f(t%360)}),[]),P=t.onRefocus,I=t.onZoomEvent,E=t.onError,C=t.onDragProgress,x=t.onReset,O=t.onDragStart,U=t.onCanvasUpdated,R=t.onEmptyImageRendered,w=t.onFileSelected,A=t.onImageLoaded,k=t.onKeyboardEvent,L=t.onRotateEvent,j=t.isUploadedPhotoTooSmall,N=tt.useCallback((function(e,n){return"Fit"===t.imageScaling&&n<256?(256-n)/2:e>0?0:e+n<256?256-n:e}),[t.imageScaling]),D=tt.useCallback((function(e,n,o,a){var i=e+(n-e)*a/t.absoluteScale,r=a*o/t.maximumScale;return N(i,r)}),[N,t.absoluteScale,t.maximumScale]),B=tt.useCallback((function(e,n,o){if(!(!t.image||t.maximumScale<1||isNaN(e))){var a=Math.min(1,Math.max(0,t.relativeScale+e));if(a!==t.relativeScale){var i=Math.exp(a*Math.log(t.maximumScale)),r=i<=1,l=i>=t.maximumScale,s=D(n,t.xpos,t.naturalWidth,i),c=D(o,t.ypos,t.naturalHeight,i);I({absoluteScale:i,relativeScale:a,zoomOutDisabled:r,zoomInDisabled:l,xpos:s,ypos:c})}}}),[t.image,t.maximumScale,t.relativeScale,t.xpos,t.naturalWidth,t.ypos,t.naturalHeight,D,I]),T=tt.useCallback((function(e){var n=(t.imageRotationAngle+e)%360;L({imageRotationAngle:n})}),[t.imageRotationAngle,L]),M=tt.useCallback((function(e){var n,o,a,i,r,l,s,c;if(t.image&&!(t.maximumScale<1)){var u="",p=t.xpos.toFixed(1),d=t.ypos.toFixed(1);switch(e.key){case"+":return B(t.stepSize,128,128);case"-":return B(-1*t.stepSize,128,128);case"ArrowLeft":u=null===(o=(n=t.strings).leftArrowKeyAriaLabel)||void 0===o?void 0:o.call(n,{p0:p,p1:d});break;case"ArrowRight":u=null===(i=(a=t.strings).rightArrowKeyAriaLabel)||void 0===i?void 0:i.call(a,{p0:p,p1:d});break;case"ArrowUp":u=null===(l=(r=t.strings).upArrowKeyAriaLabel)||void 0===l?void 0:l.call(r,{p0:p,p1:d});break;case"ArrowDown":u=null===(c=(s=t.strings).downArrowKeyAriaLabel)||void 0===c?void 0:c.call(s,{p0:p,p1:d})}e.currentTarget.setAttribute("aria-label","".concat(u));var m=ut((e.which===_t.a.left?1:e.which===_t.a.right&&-1)||0,(e.which===_t.a.up?1:e.which===_t.a.down&&-1)||0,t.orientation,t.imageRotationAngle),g=m.x,h=m.y,f=g*t.naturalWidth/100,b=h*t.naturalHeight/100,v=N(t.xpos+f,t.naturalWidth*t.absoluteScale/t.maximumScale),S=N(t.ypos+b,t.naturalHeight*t.absoluteScale/t.maximumScale);k({xpos:v,ypos:S})}}),[t.stepSize,t.orientation,t.image,t.naturalWidth,t.naturalHeight,t.xpos,t.ypos,t.absoluteScale,t.maximumScale,k,t.imageRotationAngle,B,N,t.strings]),_=tt.useCallback((function(o){var a,i,r,l=1;"Fit"===t.imageScaling?(l=1.2,i=Math.max(o.naturalWidth,o.naturalHeight),r=i*l/256):(i=Math.min(o.naturalWidth,o.naturalHeight),r=i/256);var s=function(t){return-.5*(t/r-256)},c=Math.min(1,Math.max(.01,256/(2*Math.max(o.naturalWidth,o.naturalHeight))));y(0),!t.initialRender&&r<1&&(o.naturalHeight<48||o.naturalWidth<48?setTimeout((function(){return E("IMAGE_TOO_SMALL_ERROR")}),0):setTimeout((function(){return E("IMAGE_TOO_SMALL_WARNING")}),0)),j(o.naturalHeight<48||o.naturalWidth<48),e.current||A({naturalMin:i,naturalWidth:o.naturalWidth*l,naturalHeight:o.naturalHeight*l,stepSize:c,maximumScale:r,orientation:Ft(o.src),imageRotationAngle:0,image:o,zoomInDisabled:!1,initialRender:!1,xpos:s(o.naturalWidth*l),ypos:s(o.naturalHeight*l),absoluteScale:1,relativeScale:0,imageUpdated:!1}),!t.initialRender&&(null===(a=n.current)||void 0===a||a.focus())}),[t.initialRender,E,j,A,e,n,t.imageScaling,y]),z=tt.useCallback((function(e){if(e){var n=new Image;n.onload=function(){return _(n)},n.src=e,n.alt=t.fileName||""}else x(),""===e&&R()}),[x,_,R,t.fileName]),W=tt.useCallback((function(e){if(t.image){se(e);var n=e.deltaY>0?-1:1,o=ut(e.nativeEvent.offsetX,e.nativeEvent.offsetY,t.orientation,t.imageRotationAngle),a=o.x,i=o.y;B(pt(t.stepSize,.05,.1)*n,a,i)}}),[t.image,t.orientation,t.stepSize,B,t.imageRotationAngle]),F=tt.useCallback((function(e){var n=ce(e),o=ut(n[0],n[1],t.orientation,t.imageRotationAngle),a=o.x,i=o.y;t.image&&(se(e),O({moving:!0,lastMouseX:a,lastMouseY:i}))}),[t.image,O,t.orientation,t.imageRotationAngle]),H=tt.useCallback((function(e){se(e);var n="mousemove"===e.type||"touchmove"===e.type,o=ce(e),a=ut(o[0],o[1],t.orientation,t.imageRotationAngle),i=a.x,r=a.y;if(t.image&&t.moving){var l=N(t.xpos+(i-t.lastMouseX),t.naturalWidth*t.absoluteScale/t.maximumScale),s=N(t.ypos+(r-t.lastMouseY),t.naturalHeight*t.absoluteScale/t.maximumScale);C({moving:n,xpos:l,ypos:s,lastMouseX:i,lastMouseY:r})}}),[t.orientation,t.image,t.moving,t.xpos,t.ypos,t.lastMouseX,t.lastMouseY,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,N,C,t.imageRotationAngle]),G=tt.useCallback((function(t){se(t),m(!0)}),[m]),K=tt.useCallback((function(t){se(t),m(!1)}),[m]),Y=tt.useCallback((function(e){K(e),e.dataTransfer&&w(e.dataTransfer.files[0],t.isPhotoListPresent)}),[K,w,t.isPhotoListPresent]),X=tt.useCallback((function(){var e=n.current;if(e&&o.current){var a=e.getContext("2d");if(a){var i=window.getComputedStyle(e);a.fillStyle=i.backgroundColor||"#ffffff",a.fillRect(0,0,1,1);var r=a.getImageData(0,0,1,1).data,l="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", 0.6)"),s="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", 1)"),c=Object(zt.a)({text:t.personDisplayName});""===t.dataUrl?(a.fillStyle=c,o.current.style.display="flex"):(a.fillStyle=t.customBackgroundColor||"white",o.current.style.display="none"),a.fillRect(0,0,256,256),t.image&&ct(a,256,t.imageRotationAngle,t.orientation,t.image,(function(e,n){return e.drawImage(n,t.xpos,t.ypos,t.naturalWidth*t.absoluteScale/t.maximumScale,t.naturalHeight*t.absoluteScale/t.maximumScale)})),null==U||U(e),"Circle"===t.imageCropShape&&(a.save(),a.beginPath(),a.rect(0,0,256,256),a.arc(128,128,125,0,2*Math.PI,!0),a.clip(),a.fillStyle=l,a.fillRect(0,0,256,256),a.restore(),a.save(),a.beginPath(),a.arc(128,128,126,0,2*Math.PI,!0),a.lineWidth=2,a.strokeStyle=s,a.stroke(),a.restore(),a.save(),a.beginPath(),a.lineWidth=4,a.fillStyle="rgba(0, 120, 215, 0.5)",a.strokeStyle="rgba(0, 120, 215, 0.5)",a.arc(128,128,125,-Math.PI/2,2*t.progress*Math.PI-Math.PI/2,!1),1===t.progress&&a.fill(),a.stroke(),a.restore())}else E("UNSUPPORTED_BROWSER")}}),[t.personDisplayName,t.dataUrl,t.image,t.imageRotationAngle,t.orientation,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.progress,E,t.customBackgroundColor,U,t.imageCropShape,o]);tt.useEffect((function(){return X(),function(){e.current=!0}}),[]),tt.useEffect((function(){X()})),tt.useEffect((function(){1===t.progress&&P()}),[t.progress,P]),tt.useEffect((function(){t.dataUrl&&S(i?"Rotate":"Zoom")}),[t.dataUrl,i]),tt.useEffect((function(){t.dataUrl?t.imageUpdated&&z(t.dataUrl):t.image&&(x(),R())}),[t.dataUrl,t.imageUpdated,t.image,x,R,i,z]);var Z=tt.useMemo((function(){var e,n;return t.image?1===t.progress?t.strings.success:t.fileName?null===(n=(e=t.strings).photoSelected)||void 0===n?void 0:n.call(e,{p0:t.fileName}):t.strings.dropZoneImageAriaLabel:t.strings.dropZoneEmptyAriaLabel}),[t.image,t.progress,t.fileName,t.strings]),V=tt.useRef(Object(Bt.a)());return tt.createElement("div",{className:u.canvasContainer,"aria-live":"polite"},tt.createElement("canvas",{className:"".concat(u.editCanvas," ").concat(d?u.isDropActive:""),role:"img",tabIndex:r?0:-1,ref:n,width:256,height:256,onKeyDown:function(t){return M(t)},"aria-label":Z,onDragEnter:G,onDrop:Y,onDragLeave:K,onDragOver:se,onMouseDown:F,onMouseMove:H,onMouseUp:H,onMouseLeave:H,onWheel:W,onTouchStart:F,onTouchMove:H,onTouchEnd:H,"aria-describedby":V.current}),t.image&&t.fileName&&tt.createElement("img",{alt:t.fileName,id:V.current,"aria-hidden":!0,hidden:!0}),tt.createElement("div",{className:u.textboy,ref:o,onDragEnter:G,onDragLeave:K,onDragOver:se,onDrop:Y},tt.createElement("div",{className:u.initials},a),tt.createElement("div",null,t.strings.dropZone)),tt.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},1===t.progress?tt.createElement("div",{className:u.textboy},tt.createElement("span",{className:u.invisible},t.strings.success),tt.createElement(Wt.a,{className:u.initials,iconName:"CheckMark"})):null),r?tt.createElement(tt.Fragment,null,"Zoom"!==v&&t.enableImageRotation?tt.createElement(Vt,{styles:t.styles.slider,isPhotoUploading:l,clockwiseString:t.strings.clockwise,counterClockwiseString:t.strings.counterClockwise,rotateString:t.strings.rotate,baseAngleForStraightening:h,imagePositionInformationString:t.strings.imagePositionInformationString,setBaseAngleForStraightening:y,onImageRotate:T,imageRotationAngle:t.imageRotationAngle,panEnabled:s}):tt.createElement(te,{styles:t.styles.slider,zoomOutString:t.strings.zoomOut,zoomInString:t.strings.zoomIn,zoomString:t.strings.zoom,zoomAtMaxString:t.strings.zoomAtMax||"",imageScaleInformationString:t.strings.imageScaleInformationString,isPhotoUploading:l,canvasSize:256,image:t.image,maximumScale:t.maximumScale,stepSize:t.stepSize,zoomOutDisabled:t.zoomOutDisabled,relativeScale:t.relativeScale,zoomInDisabled:t.zoomInDisabled,panEnabled:s,zoom:B}),t.enableImageRotation&&tt.createElement(ie,{styles:t.styles.pivot,zoomAtMaxString:t.strings.zoomAtMax,isPhotoUploading:l,maximumScale:t.maximumScale,selectedKey:v,setSelectedKey:S,rotateString:t.strings.rotate,zoomString:t.strings.zoom,pivotString:t.strings.pivot})):tt.createElement("div",{className:u.editControlsPlaceholderSpace}))})),de=n(2004),me=n(338),ge=n(609),he=n(348),fe=n(62),be=n(458),ve=function(t){var e,n,o=Object(xt.a)(),a=(n=t.styles,Object(be.a)((function(t){return Object(It.db)({listItem:Object(It.eb)({height:56,width:56,marginBottom:10,border:"none",boxSizing:"border-box",display:"flex",padding:0,background:"transparent",cursor:"pointer",selectors:{"&:focus":{outline:"2px solid ".concat(t.palette.themePrimary)},"&:hover":{opacity:.9,border:"1px solid ".concat(t.palette.neutralLighter)}}},null==n?void 0:n.listItem),lastListItem:{marginBottom:0},listItemSelected:Object(It.eb)({outline:"2px solid ".concat(t.palette.themePrimary),opacity:.9},null==n?void 0:n.listItemSelected),listItemWithBackground:{background:t.palette.neutralLighter},photoListItemImage:{height:"100%",width:"100%"},emptyListIcon:Object(It.eb)({margin:"auto",fontSize:"24px",color:t.palette.neutralSecondaryAlt},null==n?void 0:n.emptyListIcon)})})))(o);return tt.createElement("button",{className:Object(me.a)(a.listItem,(e={},e[a.listItemSelected]=t.index===t.selectedIndex,e[a.listItemWithBackground]=t.isEmptyPhoto,e[a.lastListItem]=t.isLastPhoto,e)),onClick:function(){var e;t.onClickHandler({selectedIndex:t.index,imageUrl:t.imageUrl||"",fileName:"".concat(t.photoListImageAriaLabel||""," ").concat(t.index+1).trim()}),t.isEmptyPhoto&&(null===(e=t.onPhotoRemoved)||void 0===e||e.call(t))},"aria-describedby":t.ariaDescribedBy},t.isEmptyPhoto?tt.createElement(ge.a,{"aria-label":t.photoListEmptyImageAriaLabel,iconName:"Contact",className:a.emptyListIcon}):tt.createElement(he.a,{src:t.imageUrl,className:a.photoListItemImage,alt:t.photoListImageAriaLabel,imageFit:fe.b.cover}))},Se=function(t){var e,n=(e=t.styles,Object(be.b)(Object(It.db)({root:Object(It.eb)({height:256,width:56,padding:"0px 25px 0px 12px",overflowY:"auto",margin:0,listStyle:"none"},null==e?void 0:e.root)}))()),o=t.imageUrls,a=t.showEmptyPhoto?o.length:o.length-1;return tt.createElement("ul",{className:n.root,"aria-label":t.strings.photoListAriaLabel},o.map((function(e,n){return tt.createElement(de.a,{posInSet:n+1,setSize:a+1,key:n,onRenderDescribedElement:function(o){return tt.createElement("li",{key:n},tt.createElement(ve,{key:n,styles:t.styles,imageUrl:e,index:n,selectedIndex:t.selectedIndex,isLastPhoto:n===a,isEmptyPhoto:!1,photoListImageAriaLabel:t.strings.photoListImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,ariaDescribedBy:o}))}})})),!!t.showEmptyPhoto&&tt.createElement(de.a,{posInSet:a+1,setSize:a+1,onRenderDescribedElement:function(e){return tt.createElement("li",null,tt.createElement(ve,{index:o.length,selectedIndex:t.selectedIndex,isLastPhoto:!0,isEmptyPhoto:!0,styles:t.styles,photoListEmptyImageAriaLabel:t.strings.photoListEmptyImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,onPhotoRemoved:t.onPhotoRemoved,ariaDescribedBy:e}))}}))},ye=(ue=function(t,e){return(ue=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ue(t,e),t.prototype=null===e?q()(e):(n.prototype=e.prototype,new n)}),Pe=function(){return(Pe=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ye(e,t),e.prototype.componentDidMount=function(){this.props.photoListLoadPhotos(this.props.photoListSelectedIndex||0,this.props.photoListImageUrls)},e.prototype.render=function(){return tt.createElement(Se,Pe({},this.props))},e}(tt.Component);var Ee=Object(it.c)((function(t){return H.getSelectors(t).getPhotoListState()}),(function(t){return{photoListLoadPhotos:function(e,n){t(T({selectedIndex:e,imageUrls:n}))},onPhotoListImageSelected:function(e){!function(t,e,n,o){if(!e)return t(S({isPhotoListPresent:!0})),void t(D({selectedIndex:n}));if(e.startsWith("data:image/"))return t(y({dataUrl:e,isPhotoListPresent:!0,fileName:o})),t(N()),void t(D({selectedIndex:n}));var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=a.naturalWidth,a.alt=o||"",e.height=a.naturalHeight;var i=e.getContext("2d");i&&(i.drawImage(a,0,0),t(y({dataUrl:rt(e,!1),isPhotoListPresent:!0,fileName:o})),t(N()),t(D({selectedIndex:n})))},a.src=e}(t,e.imageUrl,e.selectedIndex,e.fileName)}}}))(Ie),Ce=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),xe=function(){return(xe=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Oe=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof mt.a){var a=0;for(o=mt()(t);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(t,o[a])&&(n[o[a]]=t[o[a]])}return n},Ue=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var n=.5/e(1);return function(t){return t<=0?0:t>1?1:n*e(2*t-1)+.5}}(5),Re=function(t){function e(e){var n=t.call(this,e)||this;return n.focusTrap=null,n.primaryButton=null,n.uploadFileButton=null,n.onCanvasUpdated=function(t){var e,o;n.props.isCanvasDirty&&n.props.onImageChanged?n.props.onImageChanged(n.props.latestImageStats):null===(o=(e=n.props).onCanvasUpdated)||void 0===o||o.call(e,t,n.props.isCanvasDirty)},n.handleOnRemoveButtonClicked=function(){n.props.loadedEmptyImage(nt()(n.props.personImageUrl)),n.uploadFileButton&&n.uploadFileButton.focus()},n.handleOnSaveButtonClicked=function(){switch(n.props.status){case"SUCCESS":return n.props.onDone(),n.props.onDismiss();default:n.props.startUpload()}},n.handleUploadAnimation=function(){"IN_PROGRESS"===n.props.status&&n.props.onUploadProgress(at()())},n.handleOnCancelButtonClicked=function(){n.props.onCancel(),n.props.onDismiss()},n.handleOnCloseButtonClicked=function(){n.props.onClose(),n.props.onDismiss()},n.getFocusTrapRef=n.getFocusTrapRef.bind(n),n.getButtonRef=n.getButtonRef.bind(n),n.getUploadButtonRef=n.getUploadButtonRef.bind(n),n}return Ce(e,t),e.prototype.getFocusTrapRef=function(){var t=this,e=function(e){return t.focusTrap=e};return e.current=null,e},e.prototype.getButtonRef=function(){var t=this,e=function(e){return t.primaryButton=e};return e.current=null,e},e.prototype.getUploadButtonRef=function(){var t=this,e=function(e){return t.uploadFileButton=e};return e.current=null,e},e.prototype.render=function(){var t,e,n=this,o=this.getWarningText(this.props.warning);return tt.createElement(jt,{styles:this.props.styles.picker,onDismiss:this.props.onDismiss,focusTrapRef:this.getFocusTrapRef(),hideTitleText:!!this.props.hideUploadHeader,isComponentInline:!!this.props.isComponentInline,titleText:this.props.strings.uploadHeader,imageEditorDescription:this.props.strings.imageEditorDescription,hideEndActions:this.props.hideButtons,closeIcon:tt.createElement(Ct,{buttonType:"Icon",iconName:"Cancel",onClick:this.handleOnCloseButtonClicked,dataLogName:"PhotoPickerClose",title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),infoBar:o?tt.createElement(wt,{styles:this.props.styles.infoBar,warning:this.props.warning,warningText:o,onDismiss:this.props.onDismissInfoBar,dismissButtonAriaLabel:this.props.strings.infoBarDismissButtonAriaLabel}):null,uploadPhoto:this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:tt.createElement(Dt,{styles:this.props.styles.uploadPhoto,buttonRef:this.getUploadButtonRef(),onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto,uploadText:this.props.strings.upload,isPhotoListPresent:nt()(this.props.personImageUrl)}),editCanvas:tt.createElement(pe,{dataUrl:this.props.dataUrl,enableImageRotation:this.props.enableImageRotation,fileName:this.props.fileName,personDisplayName:this.props.personDisplayName,progress:this.props.progress,warning:o,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return n.props.onUploadedPhotoTooSmall(t)},styles:this.props.styles,onFileSelected:this.props.onFileSelected,onRefocus:function(){return n.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.onCanvasUpdated,isComponentInline:!!this.props.isComponentInline,customBackgroundColor:this.props.customBackgroundColor,isPhotoListPresent:nt()(this.props.personImageUrl)}),photoList:nt()(this.props.personImageUrl)?tt.createElement(Ee,{styles:this.props.styles.list,photoListImageUrls:this.props.personImageUrl,photoListSelectedIndex:this.props.photoListSelectedIndex,showEmptyPhoto:!!this.props.showPhotoListEmptyPhoto,strings:this.props.strings,onPhotoRemoved:function(){var t;null===(t=n.uploadFileButton)||void 0===t||t.focus()}}):null,applyButton:tt.createElement(Ct,{buttonType:"Primary",buttonLabel:this.getSaveButtonText(this.props.status),dataLogName:"PhotoPickerOkay",onClick:this.handleOnSaveButtonClicked,disabled:this.getIsPrimaryButtonDisabled(),buttonRef:this.getButtonRef()}),cancelButton:this.props.progress>0?null:tt.createElement(Ct,{buttonType:"Default",buttonLabel:this.props.strings.cancel,dataLogName:"PhotoPickerCancel",onClick:this.handleOnCancelButtonClicked}),removeButton:this.props.isImageRemovable?tt.createElement(Ct,{buttonType:"Action",buttonLabel:this.props.strings.remove,iconName:"Delete",dataLogName:"PhotoPickerDelete",disabled:this.getIsRemoveButtonDisabled(),onClick:this.handleOnRemoveButtonClicked}):null,customUploadButton:null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto})})},e.prototype.componentDidMount=function(){var t=this;this.props.loadCurrentImage(),requestAnimationFrame((function(){return t.focusTrap&&t.focusTrap.focus()}))},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(gt.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.getIsPrimaryButtonDisabled=function(){return!this.props.isCanvasDirty||"IN_PROGRESS"===this.props.status||this.props.isUploadedPhotoTooSmall},e.prototype.getIsRemoveButtonDisabled=function(){return!this.props.dataUrl||"IN_PROGRESS"===this.props.status},e}(tt.Component);var we={absoluteScale:0,imageRotationAngle:0,xpos:0,ypos:0},Ae=function(t){return ht.reduce((function(e,n){var o;return xe(xe({},e),((o={})[n]=Number(t[n]),o))}),we)},ke=function(t,e){return ht.some((function(n){return e[n].toFixed(4)!==t[n].toFixed(4)}))},Le=function(t,e){switch(t){case"IN_PROGRESS":return.999999*Ue(e/2e3);case"SUCCESS":return 1;case"READY":case"SOMETHING_WENT_WRONG":return 0;default:Object(gt.a)(t)}};var je=Object(it.c)((function(t){var e=H.getSelectors(t).getPhotoPickerState(),n=H.getSelectors(t).getEditCanvasState(),o=n.originalCanvasState,a=Oe(n,["originalCanvasState"]),i=Ae(a),r=Ae(o);return{dataUrl:e.dataUrl,initialImage:e.currentImageDataUrl,warning:e.warning,status:e.status,isCanvasDirty:e.isUpdated||ke(r,i),isUploadedPhotoTooSmall:e.isUploadedPhotoTooSmall,progress:Le(e.status,e.uploadDuration),latestImageStats:i,fileName:e.fileName}}),(function(t){return{onUploadedPhotoTooSmall:function(e){return t(p({isUploadedPhotoTooSmall:e}))},onDismissInfoBar:function(){return t(x())},onError:function(e){return t(P({warning:e}))},onUploadNewPhoto:function(){return t(h())},onFileSelected:function(e,n){return function(t,e,n){var o=new FileReader,a=function(){return t(P({warning:"NOT_AN_IMAGE"}))};o.onerror=a,o.onloadend=function(){var i=document.createElement("img");i.onerror=a,i.onload=function(){i.alt=e.name,t(y({dataUrl:i.src,fileName:e.name})),t(N()),n&&t(B({selectedIndex:0,newImageUrl:i.src}))},i.src=String(o.result)},o.readAsDataURL(e)}(t,e,n)},onCancel:function(){return t(d())},onClose:function(){return t(m())},onDone:function(){return t(g())},onImageEditPaneDismissed:function(){return t(f())},onImageUpdated:function(){return t(b())},onUploadProgress:function(e){return t(E({now:e}))}}}))(Re),Ne=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),De=function(){return(De=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Be=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadCurrentImage=function(){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){return e.imageLoaded(t)},t.onerror=function(){return e.imageLoadFailed()},t.src=nt()(e.props.personImageUrl)?e.props.personImageUrl[e.props.photoListSelectedIndex||0]||"":e.props.personImageUrl},e.imageLoaded=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;var o=n.getContext("2d");o?(o.drawImage(t,0,0),e.props.onLoadedCurrentImage(rt(n,e.props.isComponentInline),!!e.props.isSuggestedPhoto,nt()(e.props.personImageUrl))):e.props.onError("UNSUPPORTED_BROWSER")},e.imageLoadFailed=function(){e.props.onLoadedEmptyImage(nt()(e.props.personImageUrl))},e.startUpload=function(){var t=e.getImageDataUrlFromCanvas();e.props.onStartUpload(at()(),t,e.props.selectedIndex,e.props.imageUrls,e.props.onUpload,e.props.getPhotoListDataOnUpload)},e.getImageDataUrlFromCanvas=function(t){if(!e.props.image)return"";t||(t=648);var n=document.createElement("canvas"),o=e.props.naturalMin/e.props.absoluteScale;n.width=o,n.height=o;var a=n.getContext("2d");if(!a)return e.props.onError("UNSUPPORTED_BROWSER"),"";a.fillStyle=e.props.customBackgroundColor||"white",a.fillRect(0,0,n.width,n.height),e.props.image&&ct(a,n.width,e.props.imageRotationAngle,e.props.orientation,e.props.image,(function(t,o){return a.drawImage(o,e.props.xpos*n.width/256,e.props.ypos*n.height/256,e.props.naturalWidth,e.props.naturalHeight)}));for(var i=1;n.width*i/4>=t;)i/=2,a.drawImage(n,0,0,n.width*i,n.height*i);var r=document.createElement("canvas"),l=Math.min(e.props.naturalMin/e.props.absoluteScale,t);r.width=l,r.height=l;var s=r.getContext("2d");return s?(s.drawImage(n,0,0,n.width*i,n.width*i,0,0,l,l),rt(r,e.props.isComponentInline)):(e.props.onError("UNSUPPORTED_BROWSER"),"")},e.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},e}return Ne(e,t),e.prototype.render=function(){return tt.createElement(je,De({loadCurrentImage:this.loadCurrentImage,startUpload:this.startUpload,loadedEmptyImage:this.props.onLoadedEmptyImage,styles:this.props.styles||{}},this.props))},e}(tt.Component);var Te=Object(it.c)((function(t){return De(De({},H.getSelectors(t).getEditCanvasState()),H.getSelectors(t).getPhotoListState())}),(function(t){return{onError:function(e){return t(P({warning:e}))},onLoadedCurrentImage:function(e,n,o){return t(v({dataUrl:e,isSuggestedPhoto:n,isPhotoListPresent:o}))},onLoadedEmptyImage:function(e){return t(S({isPhotoListPresent:e}))},onStartUpload:function(e,n,o,a,i,r){return function(t,e,n,o,a,i,r){t(I({now:e})),i(n,(function(){t(C({dataUrl:n})),null==r||r(o===a.length?-1:o,a)}),(function(){return t(P({warning:"UNKNOWN"}))}))}(t,e,n,o,a,i,r)}}}))(Be),Me=n(1340);function _e(){Object(Me.a)(void 0,{disableWarnings:!0})}var ze=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),We=function(){return(We=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Fe=null,He=!1,Ge=0,Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ze(e,t),e.prototype.UNSAFE_componentWillMount=function(){if(Ge>=1)throw new Error("Can only mount one StandalonePhotoPicker at a time.");if(Ge+=1,He||(He=!0,_e()),null===Fe){var t=Object(s.createStore)(Object(J.a)([H]));Fe=new Q.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){Ge-=1},e.prototype.render=function(){return Fe?tt.createElement($.a,{context:Fe},tt.createElement(Te,We({},this.props))):null},e}(tt.Component)}}]);